<!-- AR.js by @jerome_etienne - github: https://github.com/jeromeetienne/ar.js - info: https://medium.com/arjs/augmented-reality-in-10-lines-of-html-4e193ea9fdbf -->
<!--
<script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
<script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.5.5/aframe/build/aframe-ar.js"></script>
-->
<script src="aframe.min.js"></script>
<script src="aframe-ar.js"></script>
<script src="aframe-extras.loaders.min.js"></script>
<body style='margin : 0px; overflow: hidden;'>
  <a-scene embedded arjs='sourceType: webcam;' cursor="rayOrigin: mouse">
    <a-assets>
    <!--
    <a-asset-item id="tree" src="Buggy.gltf"></a-asset-item>
    -->
	    <img id="img1" src="sb-tight.png">
	    <img id="hh" src="hh.png">
	    <img id="sm" src="sm.png">
	    <img id="m2" src="m2.png">
	    <canvas id='shape-canvas' crossorigin='anonymous' />
	  </a-assets>
  <!--
  <a-entity gltf-model="#tree" scale='0.01 0.01 0.01' animation-mixer='clip: *'></a-entity>
    -->

    <a-box id="box1" position='-1 0.5 0' material="src: #shape-canvas"></a-box>
    <a-box id='box2' position='1 -0.5 0' material="src: #sm"></a-box>
    <a-box id='box3' position='0 0 0' material="src: #hh"></a-box>

    <!--
    <a-marker-camera preset='custom' type='pattern' patternUrl='https://davidplumpton.github.com/artest/sb-fix.patt'></a-marker-camera>
    -->
    <a-marker-camera preset='hiro' class='my-camera'>
    </a-marker-camera>
  </a-scene>

  <script>
    function show(a, b, c) {
      var c = document.getElementById('shape-canvas')
      var ctx = c.getContext('2d')
			ctx.font = '20pt Arial'
      ctx.clearRect(0, 0, c.width, c.height);
      ctx.fillText(a, 10, 30)
      ctx.fillText(b, 10, 60)
      ctx.fillText(c, 10, 90)
    }

		var area = document.getElementsByClassName('a-canvas')[0];
    var handlePress = function(event, x, y) {
			var offsetX = 0
			var offsetY = 0
			var containerWidth = area.width
			var containerHeight = area.height
			var x11 = (((x - offsetX) / containerWidth) * 2) - 1
			var y11 = 1 - (((y - offsetY) / containerHeight) * 2)
			show(x, x11, containerWidth)
			var raycaster = new THREE.Raycaster()
			var pointingVector = new THREE.Vector2(x11, y11)
			var scene = document.querySelector('a-scene')
			var scene3 = scene.object3D
			var camera = scene.camera
			raycaster.setFromCamera(pointingVector, camera)
			var found = raycaster.intersectObjects(scene3.children, true)
			if (found.length > 0) {
				found[0].object.visible = false
			}
    }

		area.addEventListener('touchstart', function(event) {
			var x = event.touches[0].clientX || event.touches[0].pageX
			var y = event.touches[0].clientY || event.touches[0].pageY
			handlePress(event, x, y)
			event.preventDefault()
		})
		area.addEventListener('mousedown', function(event) {
			var x = event.clientX || event.pageX
			var y = event.clientY || event.pageY
			handlePress(event, x, y)
		})

  </script>
</body>
